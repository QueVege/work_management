{% load static %}

<html>
    <head>
        <title>WorkManagment</title>
        <link rel="stylesheet" type="text/css" href="{% static 'work/style.css' %}">
    </head>
    <body>
        <div class='container'>
            <header>
                {% if user.is_authenticated %}
                    <div class='log'><a href="{% url 'accounts:logout' %}">LogOut</a></div>
                {% else %}
                    <div class='log'><a href="{% url 'accounts:login' %}">LogIn</a></div>
                {% endif %}
                <nav class='menu'>
                    <a href="{% url 'work:comp_list' %}">Companies</a>
                    <a href="{% url 'work:worker_list' %}">Workers</a>
                    <a href="{% url 'work:create_work' %}">New</a>
                    <a href="{% url 'work:hire' %}">Hire</a>
                </nav>
            </header>
            <hr><br>
            {% block content %}
            {% endblock %}
        </div>
    </body>
    <script>
        var pageName = "{{ page_name|escapejs }}";

        var socket = new WebSocket(
            'ws://' + window.location.host +
            '/ws/' + pageName + '/');

        socket.onopen = function open() {
            console.log('WebSockets connection created at ' + pageName);
        };

        socket.onmessage = function message(event) {
            var data = JSON.parse(event.data);
            var message = data['message'];
            window.location.reload(true);
            console.log(message);
        };

        if (socket.readyState == WebSocket.OPEN) {
            socket.onopen();
        }
    </script>
</html>